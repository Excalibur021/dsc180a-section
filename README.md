Based on: https://github.com/MatthieuCourbariaux/BinaryNet/tree/master/Train-time
